fwer27_1 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/100
fwerPAR_1 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/100
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E2_6mm_onesample.RData")
fwer0_2 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/100
fwer1_2 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/100
fwer3_2 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/100
fwer9_2 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/100
fwer27_2 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/100
fwerPAR_2 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/100
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E3_6mm_onesample.RData")
fwer0_3 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/100
fwer1_3 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/100
fwer3_3 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/100
fwer9_3 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/100
fwer27_3 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/100
fwerPAR_3 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/100
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E4_6mm_onesample.RData")
fwer0_4 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/100
fwer1_4 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/100
fwer3_4 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/100
fwer9_4 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/100
fwer27_4 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/100
fwerPAR_4 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/100
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_B1_6mm_onesample.RData")
fwer0_b1 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/100
fwer1_b1 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/100
fwer3_b1 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/100
fwer9_b1 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/100
fwer27_b1 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/100
fwerPAR_b1 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/100
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_B2_6mm_onesample.RData")
fwer0_b3 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/100
fwer1_b3 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/100
fwer3_b3 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/100
fwer9_b3 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/100
fwer27_b3 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/100
fwerPAR_b3 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/100
db <- data.frame(fwer = c(fwer0_1, fwer1_1, fwer3_1, fwer9_1, fwer27_1, fwerPAR_1,
fwer0_2, fwer1_2, fwer3_2, fwer9_2, fwer27_2, fwerPAR_2,
fwer0_3, fwer1_3, fwer3_3, fwer9_3, fwer27_3, fwerPAR_3,
fwer0_4, fwer1_4, fwer3_4, fwer9_4, fwer27_4, fwerPAR_4,
fwer0_b1, fwer1_b1, fwer3_b1, fwer9_b1, fwer27_b1, fwerPAR_b1,
fwer0_b3, fwer1_b3, fwer3_b3, fwer9_b3, fwer27_b3, fwerPAR_b3),
Design = c(rep("E1", 6),
rep("E2", 6),
rep("E3", 6),
rep("E4", 6),
rep("boxcar10", 6),
rep("boxcar30", 6)),
Family = c(rep(c(paste0("Permutation-based Simes", expression(delta = 0)),
paste0("Permutation-based Simes", expression(delta = 1)),
paste0("Permutation-based Simes", expression(delta = 3)),
paste0("Permutation-based Simes", expression(delta = 9)),
paste0("Permutation-based Simes", expression(delta = 27)),
"Parametric Simes"), 6)))
db
legend_labels <- c("Parametric Simes",
expression(paste("Permutation-based Simes ", delta, "=0")),
expression(paste("Permutation-based Simes ", delta, "=1")),
expression(paste("Permutation-based Simes ", delta, "=3")),
expression(paste("Permutation-based Simes ", delta, "=9")),
expression(paste("Permutation-based Simes ", delta, "=27")))
mycols = c("blue", "lightgrey", "grey", "magenta", "cyan", "black")
level_order <- rev(c("E1", "E2", "E3", "E4", "boxcar10", "boxcar30"))
ggplot(db, aes(x =fwer , y =factor(Design, level = level_order), fill = Family)) +
geom_bar(stat = "identity", width = 0.5, position = position_dodge(0.8))+
xlab("Estimated FWER") +
scale_fill_manual(labels = legend_labels, values = gray.colors(6)
) +
# scale_fill_grey() +
theme_classic() + ylab('Design') +
geom_vline(xintercept = 0.05 + 2*sqrt(0.05*(1-0.05)/1000), col = "red", linetype = "dotdash")+
geom_vline(xintercept = 0.05 - 2*sqrt(0.05*(1-0.05)/1000), col = "red", linetype = "dotdash")+
geom_vline(xintercept = 0.05, col = "red")+
theme(legend.text.align = 0)
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E1_6mm_onesample.RData")
fwer0_1 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer0_1
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E1_6mm_onesample.RData")
fwer0_1 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_1 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_1 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_1 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_1 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_1 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E2_6mm_onesample.RData")
fwer0_2 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_2 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_2 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_2 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_2 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_2 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
fwer0_2
fwer1_2 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer1_2
fwerPAR_2
fwer9_2
fwer27_2
fwer3_2
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E1_6mm_onesample.RData")
fwer0_1 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_1 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_1 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_1 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_1 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_1 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E2_6mm_onesample.RData")
fwer0_2 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_2 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_2 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_2 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_2 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_2 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E4_6mm_onesample.RData")
fwer0_4 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_4 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_4 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_4 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_4 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_4 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_B1_6mm_onesample.RData")
fwer0_b1 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_b1 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_b1 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_b1 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_b1 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_b1 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_B2_6mm_onesample.RData")
fwer0_b3 <- sum(sapply(seq(100), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_b3 <- sum(sapply(seq(100), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_b3 <- sum(sapply(seq(100), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_b3 <- sum(sapply(seq(100), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_b3 <- sum(sapply(seq(100), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_b3 <- sum(sapply(seq(100), function(x) out_par[[x]])>0)/1000
db <- data.frame(fwer = c(fwer0_1, fwer1_1, fwer3_1, fwer9_1, fwer27_1, fwerPAR_1,
fwer0_2, fwer1_2, fwer3_2, fwer9_2, fwer27_2, fwerPAR_2,
fwer0_3, fwer1_3, fwer3_3, fwer9_3, fwer27_3, fwerPAR_3,
fwer0_4, fwer1_4, fwer3_4, fwer9_4, fwer27_4, fwerPAR_4,
fwer0_b1, fwer1_b1, fwer3_b1, fwer9_b1, fwer27_b1, fwerPAR_b1,
fwer0_b3, fwer1_b3, fwer3_b3, fwer9_b3, fwer27_b3, fwerPAR_b3),
Design = c(rep("E1", 6),
rep("E2", 6),
rep("E3", 6),
rep("E4", 6),
rep("boxcar10", 6),
rep("boxcar30", 6)),
Family = c(rep(c(paste0("Permutation-based Simes", expression(delta = 0)),
paste0("Permutation-based Simes", expression(delta = 1)),
paste0("Permutation-based Simes", expression(delta = 3)),
paste0("Permutation-based Simes", expression(delta = 9)),
paste0("Permutation-based Simes", expression(delta = 27)),
"Parametric Simes"), 6)))
db
legend_labels <- c("Parametric Simes",
expression(paste("Permutation-based Simes ", delta, "=0")),
expression(paste("Permutation-based Simes ", delta, "=1")),
expression(paste("Permutation-based Simes ", delta, "=3")),
expression(paste("Permutation-based Simes ", delta, "=9")),
expression(paste("Permutation-based Simes ", delta, "=27")))
mycols = c("blue", "lightgrey", "grey", "magenta", "cyan", "black")
level_order <- rev(c("E1", "E2", "E3", "E4", "boxcar10", "boxcar30"))
ggplot(db, aes(x =fwer , y =factor(Design, level = level_order), fill = Family)) +
geom_bar(stat = "identity", width = 0.5, position = position_dodge(0.8))+
xlab("Estimated FWER") +
scale_fill_manual(labels = legend_labels, values = gray.colors(6)
) +
# scale_fill_grey() +
theme_classic() + ylab('Design') +
geom_vline(xintercept = 0.05 + 2*sqrt(0.05*(1-0.05)/1000), col = "red", linetype = "dotdash")+
geom_vline(xintercept = 0.05 - 2*sqrt(0.05*(1-0.05)/1000), col = "red", linetype = "dotdash")+
geom_vline(xintercept = 0.05, col = "red")+
theme(legend.text.align = 0)
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E1_6mm_onesample.RData")
fwer0_1 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_1 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_1 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_1 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_1 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_1 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
fwer0_1
fwer1_1
fwer3_1
fwer9_1
fwer27_1
fwerPAR_1
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E2_6mm_onesample.RData")
fwer0_2 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_2 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_2 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_2 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_2 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_2 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
fwer0_2
fwer1_2
fwer3_2
fwer27_2
fwerPAR_2
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E3_6mm_onesample.RData")
fwer0_3 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_3 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_3 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_3 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_3 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_3 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E1_6mm_onesample.RData")
fwer0_1 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_1 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_1 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_1 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_1 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_1 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E2_6mm_onesample.RData")
fwer0_2 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_2 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_2 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_2 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_2 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_2 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E3_6mm_onesample.RData")
fwer0_3 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_3 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_3 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_3 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_3 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_3 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_E4_6mm_onesample.RData")
fwer0_4 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_4 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_4 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_4 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_4 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_4 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_B1_6mm_onesample.RData")
fwer0_b1 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_b1 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_b1 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_b1 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_b1 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_b1 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
load("C:/Users/Angela Andreella/Documents/Thesis_Doc/Permutation_based_ARI/ScriptPaper/Output/Beijing_B2_6mm_onesample.RData")
fwer0_b3 <- sum(sapply(seq(1000), function(x) out_0[[x]]$discoveries)>0)/1000
fwer1_b3 <- sum(sapply(seq(1000), function(x) out_1[[x]]$discoveries)>0)/1000
fwer3_b3 <- sum(sapply(seq(1000), function(x) out_3[[x]]$discoveries)>0)/1000
fwer9_b3 <- sum(sapply(seq(1000), function(x) out_9[[x]]$discoveries)>0)/1000
fwer27_b3 <- sum(sapply(seq(1000), function(x) out_27[[x]]$discoveries)>0)/1000
fwerPAR_b3 <- sum(sapply(seq(1000), function(x) out_par[[x]])>0)/1000
db <- data.frame(fwer = c(fwer0_1, fwer1_1, fwer3_1, fwer9_1, fwer27_1, fwerPAR_1,
fwer0_2, fwer1_2, fwer3_2, fwer9_2, fwer27_2, fwerPAR_2,
fwer0_3, fwer1_3, fwer3_3, fwer9_3, fwer27_3, fwerPAR_3,
fwer0_4, fwer1_4, fwer3_4, fwer9_4, fwer27_4, fwerPAR_4,
fwer0_b1, fwer1_b1, fwer3_b1, fwer9_b1, fwer27_b1, fwerPAR_b1,
fwer0_b3, fwer1_b3, fwer3_b3, fwer9_b3, fwer27_b3, fwerPAR_b3),
Design = c(rep("E1", 6),
rep("E2", 6),
rep("E3", 6),
rep("E4", 6),
rep("boxcar10", 6),
rep("boxcar30", 6)),
Family = c(rep(c(paste0("Permutation-based Simes", expression(delta = 0)),
paste0("Permutation-based Simes", expression(delta = 1)),
paste0("Permutation-based Simes", expression(delta = 3)),
paste0("Permutation-based Simes", expression(delta = 9)),
paste0("Permutation-based Simes", expression(delta = 27)),
"Parametric Simes"), 6)))
db
legend_labels <- c("Parametric Simes",
expression(paste("Permutation-based Simes ", delta, "=0")),
expression(paste("Permutation-based Simes ", delta, "=1")),
expression(paste("Permutation-based Simes ", delta, "=3")),
expression(paste("Permutation-based Simes ", delta, "=9")),
expression(paste("Permutation-based Simes ", delta, "=27")))
mycols = c("blue", "lightgrey", "grey", "magenta", "cyan", "black")
level_order <- rev(c("E1", "E2", "E3", "E4", "boxcar10", "boxcar30"))
ggplot(db, aes(x =fwer , y =factor(Design, level = level_order), fill = Family)) +
geom_bar(stat = "identity", width = 0.5, position = position_dodge(0.8))+
xlab("Estimated FWER") +
scale_fill_manual(labels = legend_labels, values = gray.colors(6)
) +
# scale_fill_grey() +
theme_classic() + ylab('Design') +
geom_vline(xintercept = 0.05 + 2*sqrt(0.05*(1-0.05)/1000), col = "red", linetype = "dotdash")+
geom_vline(xintercept = 0.05 - 2*sqrt(0.05*(1-0.05)/1000), col = "red", linetype = "dotdash")+
geom_vline(xintercept = 0.05, col = "red")+
theme(legend.text.align = 0)
(47+25)/72
(47+25)/97
47/72
rbind(c(38,45), c( 74, 146))
riga1 <- c(38,45)
riga2 <- c( 74, 146)
rbind(riga1,riga2)
db <- rbind(riga1,riga2)
dimnames(db) <- list(Sesso = c("F", "M"),
Risposta = c("Favorevoli","Non favorevoli"))
db
as.table(rbind(riga1,riga2))
rbind(riga1,riga2)
db <- rbind(riga1,riga2)
colnames(db)
db <- rbind(riga1,riga2)
(Xsq <- chisq.test(db, correct = F)
)
matrix(c(38,45, 74, 146), byrow = T, ncol = 2)
matrix(c(38,45, 74, 146), byrow = F, ncol = 2)
db <- matrix(c(38,45, 74, 146), byrow = T, ncol = 2)
(Xsq <- chisq.test(db, correct = F))
X <- c(8,7,10,2,3,5,6,8)
rank(X)
rank(X, ties.method = 1)
rank(X, ties.method = "first")
rank(X, ties.method = "last")
rank(X, ties.method = "average")
rank(X, ties.method = "max")
rank(X, ties.method = "min")
X
rank(X)
Peso <- c(93,79,86,94,84,83,80,70,75)
Peso^2
mean(Peso^2)
mean(Peso^2) - mean(Peso)^2
mean(Peso)^2
sum(Peso)
x <- c(1,1,2,2,10)
mean(x)
sum(x)
x <- c(1,1,2,3,10)
mean(x)
x <- c(1,1,2,4,10)
mean(x)
x <- c(1,1,3,3,10)
mean(x)
x <- c(1,1,3,4,10)
mean(x)
sum(x)
x <- c(1,1,4,4,10)
mean(x)
x <- c(1,1,2,2,14)
mean(x)
x <- c(1,1,1,1,16)
mean(x)
median(x)
4/5
1/5
95/2
20*12
0.369 - 0.31
0.375-0.305
0.386-0.294
sample(c(1:20), 5)
X <- sample(c(1:20), 5)
Y <- sample(c(1:20), 5)
X
Y
rank(X)
rank(Y)
cor(X,Y, method = "spearman")
sqrt(sum((ranK(X) - mean(X))*(rank(Y)-mean(Y))))/(sd(rank(X)) *sd(rank(Y)))
sqrt(sum((rank(X) - mean(X))*(rank(Y)-mean(Y))))/(sd(rank(X)) *sd(rank(Y)))
(sum((rank(X) - mean(X))*(rank(Y)-mean(Y))))/(sd(rank(X)) *sd(rank(Y)))
cov(rank(X), rank(Y))/(sd(rank(X))*sd(rank(Y)))
X <- c(9.9, 9.7, 10.0, 10.1, 9.9, 9.6, 9.8, 9.8, 10.0, 9.5, 9.7, 10.1, 9.9, 9.6, 10.2, 9.8, 10.0, 9.9, 9.5, 9.9)
hist(X)
hist(X, freq = F)
lines(density(X))
pv <- round(runif(1, min = 0.01, max = 0.1),3)
alphas <- c(0.01, 0.05, 0.025, 0.1, 0.001, 0.005)
alpha <- min(alphas[which(alphas > pv )])
pv
alphas
alpha
alpha
alpha/2
alpha
pv <- round(runif(1, min = 0.005, max = 0.1),3)
pv
alphas <- c(0.01, 0.05, 0.025, 0.1, 0.001, 0.005)
alpha <- min(alphas[which(alphas > pv )])
alpha
pv <- round(runif(1, min = 0.001, max = 0.1),3)
alphas <- c(0.01, 0.05, 0.025, 0.1, 0.001, 0.005)
alpha <- min(alphas[which(alphas > pv )])
alpha
pv
x <- c(1:5)
y <- c(3,7,5,11,14)
mod <- lm(y ~ x)
summary(mod)
plot(x,y)
lines(mod)
lines(fitted(mod))
plot(x,y, ylim = c(0,15))
lines(fitted(mod))
plot(x,y, ylim = c(0,15), xlim = c(0,5))
lines(fitted(mod))
0.547 * 0.503
(0.547 * 0.503)/0.432
setwd("F:/FSL/FoodNoFood/volume/")
library(RNifti)
i = 1
img <- readNifti(file = paste0("sub-", i. ".nii.gz"))
paste0("sub-", i. ".nii.gz")
paste0("sub-", i ".nii.gz")
i
paste0("sub-", i, ".nii.gz")
idx <- ifelse(i < 10, paste0("0",i), paste0(i))
idx
img <- readNifti(file = paste0("sub-", idx, ".nii.gz"))
dim(img)
j = 1
img_t <- img[,,,j]
dim(img_t)
writeNifti(img_t, file = paste0("sub-", idx, "_t-" j, "nii.gz" ))
writeNifti(img_t, file = paste0("sub-", idx, "_t-", j, "nii.gz" ))
writeNifti(img_t, file = paste0("sub-", idx, "_t", j, "nii.gz" ),
template = img)
library(RNifti)
setwd("F:/FSL/FoodNoFood/volume/")
for(i in seq(30)){
idx <- ifelse(i < 10, paste0("0",i), paste0(i))
img <- readNifti(file = paste0("sub-", idx, ".nii.gz"))
for(j in seq(dim(img)[4])){
img_t <- img[,,,j]
writeNifti(img_t, file = paste0("sub-", idx, "_t", j, "nii.gz" ),
template = img)
}
}
dim(img)
370
553.2+24.07
(553.2+24.07)/1.6
580/1.6
370/1.6
370*1.6
0/1.6
40.1/1.6
26
26*8
77.2/1.6
round(77.2/1.6) + 1
49*8
40.1+24.06
(40.1+24.06)/1.6
40*8
10/1.6
i
i=1
idx <- ifelse(i < 10, paste0("0",i), paste0(i))
img <- readNifti(file = paste0("sub-", idx, ".nii.gz"))
dim(img)
i=5
idx <- ifelse(i < 10, paste0("0",i), paste0(i))
img <- readNifti(file = paste0("sub-", idx, ".nii.gz"))
dim(img)
553.2+24.07
577.27/1.6
370*1.6
592/60
370/8
targets <- read.table("F:/Post_Doc/Clustering_residual/mds/Food/sub-01_func_sub-01_task-passiveimageviewing_events.tsv",header = T)
targets$volumes <- round(round(targets$onset)/1.6)
targets <- rbind(targets, rep(NA, 4))
targets$volumes[18] <- round(targets$volumes[17] + targets$duration[17])
targets_vol <-  unlist(sapply(c(1:17), function(x){
rep(targets$trial_type[x], targets$volumes[x+1] - targets$volumes[x])
}, simplify = FALSE))
targets_vol
targets$First_volume <- round(targets$onset/1.6) + 1
targets
round(targets$onset)/1.6
370/8
for(i in seq(30)){
idx <- ifelse(i < 10, paste0("0",i), paste0(i))
img <- readNifti(file = paste0("sub-", idx, ".nii.gz"))
print(dim(img)[4])
}
tp <- c()
for(i in seq(30)){
idx <- ifelse(i < 10, paste0("0",i), paste0(i))
img <- readNifti(file = paste0("sub-", idx, ".nii.gz"))
tp[i] <- dim(img)[4]
}
tp
targets <- read.table("F:/Post_Doc/Clustering_residual/mds/Food/sub-01_func_sub-01_task-passiveimageviewing_events.tsv",header = T)
targets$volumes <- round(round(targets$onset)/1.6)
targets
rep(NA, 4)
targets <- rbind(targets, rep(NA, 4))
targets$volumes[17] + targets$duration[17]
targets$volumes[18] <- round(targets$volumes[17] + targets$duration[17])
targets
targets$First_volume <- round(targets$onset/1.6) + 1
targets
# Chunk 1
alpha <- sample(c(0.01, 0.05, 0.1),1)
n <- sample(c(5,6,7),1)
prima <- round(rnorm(n, mean = 80, sd = 2),2)
dopo <- round(prima + rnorm(n),2)
diff <- prima - dopo
tab <- data.frame(Prima = prima, Dopo = dopo, Differenza = diff)
out <- t.test(prima-dopo)
sol <- round(out$statistic, 3)[[1]]
SINO <- ifelse(out$p.value > alpha, "NO", "SI")
sol <- c(sol, SINO)
tab
out
out <- t.test(prima-dopo, alternative = c("greater"))
out
qt(1-alpha, n-1)
400*0.937
380*0.937
553.2+	24.07
48*8
